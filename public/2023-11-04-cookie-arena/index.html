

<!DOCTYPE html>
<html lang="en-us">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>Cookie Arena WriteUp - </title><meta name="Description" content="Solution for Forensics and Stegano of CookieArena challenge"><meta property="og:title" content="Cookie Arena WriteUp" />
<meta property="og:description" content="Solution for Forensics and Stegano of CookieArena challenge" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/2023-11-04-cookie-arena/" /><meta property="og:image" content="http://localhost:1313/ryus3i.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-15T01:19:58+07:00" />
<meta property="article:modified_time" content="2023-11-15T01:19:58+07:00" /><meta property="og:site_name" content="Hi" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/ryus3i.png" /><meta name="twitter:title" content="Cookie Arena WriteUp"/>
<meta name="twitter:description" content="Solution for Forensics and Stegano of CookieArena challenge"/>
<meta name="application-name" content="DoIt">
<meta name="apple-mobile-web-app-title" content="DoIt">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://localhost:1313/2023-11-04-cookie-arena/" /><link rel="prev" href="http://localhost:1313/2024-03-25-texsawctf-2024/" /><link rel="next" href="http://localhost:1313/2023-11-27-eyesopenctf-wu/" />
<link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/fontawesome-free/all.min.css">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Cookie Arena WriteUp",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http://localhost:1313/2023-11-04-cookie-arena/"
        },"genre": "posts","keywords": "WriteUp, Forensics, CookieArena","wordcount":  290 ,
        "url": "http://localhost:1313/2023-11-04-cookie-arena/","datePublished": "2023-11-15T01:19:58+07:00","dateModified": "2023-11-15T01:19:58+07:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Bear4Ts1ck"
            },"description": "Solution for Forensics and Stegano of CookieArena challenge"
    }
    </script></head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark'); window.theme = theme;   window.isDark = window.theme !== 'light' }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
        window.switchThemeEventSet = new Set()
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title=""><img
        class="logo"
        loading="lazy"
        src="/Bear2Bear.jpeg"
        srcset="/Bear2Bear.jpeg, /Bear2Bear.jpeg 1.5x, /Bear2Bear.jpeg 2x"
        alt="/Bear2Bear.jpeg"
        title="/Bear2Bear.jpeg" >Blogs</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/categories"> Categories </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title=""><img
        class="logo"
        loading="lazy"
        src="/Bear2Bear.jpeg"
        srcset="/Bear2Bear.jpeg, /Bear2Bear.jpeg 1.5x, /Bear2Bear.jpeg 2x"
        alt="/Bear2Bear.jpeg"
        title="/Bear2Bear.jpeg" >Blogs</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/categories" title="">Categories</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "false")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Cookie Arena WriteUp</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><span class="author fas fa-user-circle fa-fw"></span><a href="/" title="Author" rel=" author" class="author">Bear4Ts1ck</a>
                </span>&nbsp;<span class="post-category">included in </span>&nbsp;<span class="post-category">category <a href="/categories/blog/"><i class="far fa-folder fa-fw"></i>Blog</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2023-11-15">2023-11-15</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;290 words&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="true">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#10x0">1.0x0</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Solution for Forensics and Stegano of CookieArena challenge.</p>
<h3 id="10x0" class="headerLink">
    <a href="#10x0" class="header-mark"></a>1.0x0</h3><ul>
<li>
<p>Download and open the initial file, which is a regular image named &ldquo;legit.png&rdquo;.</p>
<p><figure><img
        
        loading="lazy"
        src="/Cookie-Arena/legit.png"
        srcset="/Cookie-Arena/legit.png, /Cookie-Arena/legit.png 1.5x, /Cookie-Arena/legit.png 2x"
        alt="Smile"
        title="Smile" ></figure></p>
</li>
<li>
<p>I tried using binwalk to check, and it seems there are some hidden files within it:</p>
<p><figure><img
        
        loading="lazy"
        src="/Cookie-Arena/image.png"
        srcset="/Cookie-Arena/image.png, /Cookie-Arena/image.png 1.5x, /Cookie-Arena/image.png 2x"
        alt="Smile"
        title="Smile" ></figure></p>
</li>
<li>
<p>Attempted to use binwalk and foremost to extract, but it seems unfeasible. I used zsteg:</p>
<p><figure><img
        
        loading="lazy"
        src="/Cookie-Arena/offset.png"
        srcset="/Cookie-Arena/offset.png, /Cookie-Arena/offset.png 1.5x, /Cookie-Arena/offset.png 2x"
        alt="Smile"
        title="Smile" ></figure></p>
</li>
<li>
<p>Spent quite some time here trying to find a way to extract that data. After a while, I found a way using the &lsquo;dd&rsquo; command. I used the following command to extract the data: <code>dd if=legit.png bs=1 skip=$((0x96ef4)) of=out</code>.</p>
</li>
<li>
<p>Upon extraction, I noticed it was a PNG file. I removed the excess parts at the beginning, but it didn&rsquo;t open correctly. Used: <code>pngcheck -vv out</code>.</p>
<p><figure><img
        
        loading="lazy"
        src="/Cookie-Arena/pngcheck.png"
        srcset="/Cookie-Arena/pngcheck.png, /Cookie-Arena/pngcheck.png 1.5x, /Cookie-Arena/pngcheck.png 2x"
        alt="Smile"
        title="Smile" ></figure></p>
</li>
<li>
<p>Got a 0x0 error. I searched for this error online and found a post by requroku / POCKekers, solving the CTF Killer Queen 2021. It seems the height and width of the image were changed to zero. Used the following Python code to find the correct height and width:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="n">p32</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">zlib</span> <span class="kn">import</span> <span class="n">crc32</span>
</span></span><span class="line"><span class="cl"><span class="n">required_crc</span> <span class="o">=</span> <span class="mh">0x41305C20</span>
</span></span><span class="line"><span class="cl"><span class="n">max_dimension</span> <span class="o">=</span> <span class="mi">4000</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">width</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_dimension</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">height</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_dimension</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">ihdr</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x49\x48\x44\x52</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">endian</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x08\x06\x00\x00\x00</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">height</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ihdr:&#39;</span><span class="p">,</span> <span class="n">ihdr</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc</span> <span class="o">=</span> <span class="n">crc32</span><span class="p">(</span><span class="n">ihdr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">crc</span> <span class="o">==</span> <span class="n">required_crc</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FOUND!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">exit</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>and we found:</p>
<p><figure><img
        
        loading="lazy"
        src="/Cookie-Arena/value.png"
        srcset="/Cookie-Arena/value.png, /Cookie-Arena/value.png 1.5x, /Cookie-Arena/value.png 2x"
        alt="Smile"
        title="Smile" ></figure></p>
<ul>
<li>
<p>Convert the values to hex and fix:</p>
<p><figure><img
        
        loading="lazy"
        src="/Cookie-Arena/changehex.png"
        srcset="/Cookie-Arena/changehex.png, /Cookie-Arena/changehex.png 1.5x, /Cookie-Arena/changehex.png 2x"
        alt="Smile"
        title="Smile" ></figure></p>
</li>
<li>
<p>Open the image again:</p>
<p><figure><img
        
        loading="lazy"
        src="/Cookie-Arena/donepng.png"
        srcset="/Cookie-Arena/donepng.png, /Cookie-Arena/donepng.png 1.5x, /Cookie-Arena/donepng.png 2x"
        alt="Smile"
        title="Smile" ></figure></p>
</li>
<li>
<p>Following the post mentioned earlier, I thought the next step was to use the stegsolve tool. Used it to check different color planes, and in the blue plane 1, we see:</p>
<p><figure><img
        
        loading="lazy"
        src="/Cookie-Arena/flag.png"
        srcset="/Cookie-Arena/flag.png, /Cookie-Arena/flag.png 1.5x, /Cookie-Arena/flag.png 2x"
        alt="Smile"
        title="Smile" ></figure></p>
</li>
<li>
<p>Scanned the QR code and received the flag:<br>
-&gt; <em>CHH{Im4g3_1n_1m@gE_1s_n1c3!!}</em></p>
</li>
</ul></div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-11-15</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share"></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=""></a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2024-03-25-texsawctf-2024/" class="prev" rel="prev" title=""><i class="fas fa-angle-left fa-fw"></i></a>
            <a href="/2023-11-27-eyesopenctf-wu/" class="next" rel="next" title="EyesOpen CTF WriteUp">EyesOpen CTF WriteUp<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.124.1">Hugo</a>&nbsp;|&nbsp;Theme - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.4.0"><i class="far fa-edit fa-fw"></i> DoIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank" rel="noopener noreferrer">h4sh1334r</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="Back to Top">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
            <i class="fas fa-comment fa-fw"></i>
        </a>
    </div><div id="cookieconsent-container"></div><div class="assets"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/katex/copy-tex.min.css">
        <noscript><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"No results found","snippetLength":30,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"sharerjs":true,"table":{"sort":true}};</script><script type="text/javascript" src="/lib/tablesort/tablesort.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js" defer></script><script type="text/javascript" src="/lib/katex/auto-render.min.js" defer></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js" defer></script><script type="text/javascript" src="/lib/katex/mhchem.min.js" defer></script><script type="text/javascript" src="/js/katex.min.js" defer></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script type="text/javascript" src="/js/cookieconsent.min.js" defer></script><script type="text/javascript" src="/js/theme.min.js" defer></script></div>
</body>

</html>
